# SOW: Playwright E2Eテスト実装

## 📋 プロジェクト概要

### 目的
Morrowアプリの包括的なE2Eテストスイートを Playwright を使って実装し、アプリケーションの品質向上と回帰防止を実現する。

### スコープ
- 既存機能の100%カバレッジを目指すE2Eテストの実装
- Playwright Docker環境の構築
- CI/CDパイプラインへの統合
- テストレポートとカバレッジの可視化

## 🎯 現在の開発状況分析

### 実装済み機能
- **ホーム画面**: Hero section, 機能紹介, イベント表示
- **オンボーディング**: 4段階のプログレス表示付きフロー
- **イベント作成**: React Hook Form + Yup バリデーション
- **イベント一覧**: 検索・フィルタリング機能付き
- **イベント詳細**: リアルタイムカウントダウン表示
- **GraphQL API**: 完全なCRUD操作対応

### 技術スタック
- **フロントエンド**: React 18 + Vite + TypeScript + Tailwind CSS
- **バックエンド**: Go + Gin + GraphQL + PostgreSQL
- **開発環境**: Docker Compose
- **テスト**: Jest + React Testing Library（既存）

## 🧪 テストケース設計（100%カバレッジ）

### 1. ホーム画面テスト
- **初回訪問時**
  - Hero sectionの表示確認
  - 機能紹介カードの表示（3つのfeature cards）
  - "イベントを作成"ボタンの動作
  - "始めましょう"ボタンでオンボーディングへの遷移

- **イベント存在時**
  - イベントカードの表示
  - イベント削除機能（確認ダイアログ含む）
  - イベント共有機能
  - カウントダウン表示の正確性

### 2. オンボーディングフローテスト
- **4段階プログレス**
  - Step 1: ウェルカム画面
  - Step 2: 機能紹介
  - Step 3: 利用方法説明
  - Step 4: 開始準備完了
- **ナビゲーション**
  - "次へ"ボタンでの進行
  - "戻る"ボタンでの後退
  - プログレスバーの更新
  - "スキップ"機能
  - 最終画面からホームへの遷移

### 3. イベント作成フローテスト
- **フォーム入力**
  - タイトル入力（必須バリデーション）
  - 説明入力（オプション）
  - 絵文字選択
  - 開始日時選択（過去日時バリデーション）
  - 終了日時選択（開始日時より後バリデーション）
  - 公開設定（public/private）

- **バリデーション**
  - 空のタイトルでエラー表示
  - 過去の日時選択でエラー表示
  - 終了日時が開始日時より前でエラー表示
  - リアルタイムバリデーション

- **送信処理**
  - 正常なデータでの作成成功
  - ローディング状態の表示
  - 作成後のイベント一覧画面への遷移
  - GraphQL mutation の実行確認

### 4. イベント一覧画面テスト
- **表示機能**
  - イベントカードの一覧表示
  - リアルタイムカウントダウン
  - 空の状態での適切なメッセージ

- **検索機能**
  - タイトルでの部分一致検索
  - リアルタイム検索結果更新
  - 検索結果なしの状態

- **フィルタリング**
  - "すべて"フィルタ
  - "開催予定"フィルタ
  - "終了済み"フィルタ
  - フィルタ変更時の結果更新

- **ナビゲーション**
  - イベント詳細画面への遷移
  - 新規作成ボタンの動作

### 5. イベント詳細画面テスト
- **表示機能**
  - イベント情報の詳細表示
  - 大きなカウントダウン表示
  - パンくずリスト
  - 編集・削除ボタン（現在はアラート表示）

- **エラーハンドリング**
  - 存在しないイベントIDでの404エラー
  - ネットワークエラー時の適切な表示

- **インタラクション**
  - 編集ボタンクリック（準備中アラート）
  - 削除ボタンクリック（準備中アラート）
  - 共有ボタンクリック（準備中アラート）

### 6. GraphQL APIテスト
- **クエリ実行**
  - GetEvents クエリの正常実行
  - GetEvent クエリの正常実行
  - CreateEvent mutation の正常実行

- **エラーハンドリング**
  - ネットワークエラー時の適切な表示
  - GraphQLエラー時の適切な表示
  - ローディング状態の管理

### 7. レスポンシブデザインテスト
- **デスクトップ表示** (1920x1080)
- **タブレット表示** (768x1024)
- **モバイル表示** (375x667)
- **各画面での適切なレイアウト**

### 8. ブラウザ互換性テスト
- **Chrome** (最新版)
- **Firefox** (最新版)
- **Safari** (最新版)
- **Edge** (最新版)

### 9. パフォーマンステスト
- **ページ読み込み時間**
- **カウントダウン更新パフォーマンス**
- **大量イベント表示時のパフォーマンス**

### 10. アクセシビリティテスト
- **キーボードナビゲーション**
- **スクリーンリーダー対応**
- **ARIA属性の適切な使用**
- **カラーコントラスト**

## 🛠️ 技術仕様

### Playwright 設定
- **テストランナー**: Playwright Test
- **ブラウザ**: Chromium, Firefox, WebKit
- **レポート**: HTML Report + JUnit XML
- **スクリーンショット**: 失敗時自動キャプチャ
- **ビデオ録画**: 失敗時のみ

### Docker 統合
- **既存のplaywrightサービス利用**
- **テスト実行環境の分離**
- **CI/CD パイプライン統合**

### テストデータ管理
- **テスト用データベース** の準備
- **テストデータのsetup/teardown**
- **独立したテスト実行環境**

## 📁 ファイル構成

```
frontend/
├── e2e/                           # 新規作成
│   ├── tests/
│   │   ├── home.spec.ts           # ホーム画面テスト
│   │   ├── onboarding.spec.ts     # オンボーディングテスト
│   │   ├── event-creation.spec.ts # イベント作成テスト
│   │   ├── event-list.spec.ts     # イベント一覧テスト
│   │   ├── event-detail.spec.ts   # イベント詳細テスト
│   │   ├── graphql-api.spec.ts    # GraphQL APIテスト
│   │   └── responsive.spec.ts     # レスポンシブテスト
│   ├── fixtures/
│   │   ├── test-data.ts           # テストデータ定義
│   │   └── mock-events.ts         # モックイベントデータ
│   ├── utils/
│   │   ├── test-helpers.ts        # テストヘルパー関数
│   │   └── page-objects.ts        # Page Objectパターン
│   └── playwright.config.ts       # Playwright設定
├── package.json                   # スクリプト追加
└── docker-compose.yml             # playwrightサービス設定
```

## 📋 実装計画

### Phase 1: 環境構築（1日）
- [ ] Playwright設定ファイル作成
- [ ] Docker Compose playwright サービス設定
- [ ] 基本的なテスト実行環境構築
- [ ] CI/CD パイプライン基本統合

### Phase 2: 基本機能テスト（2日）
- [ ] ホーム画面テスト実装
- [ ] オンボーディングフローテスト実装
- [ ] 基本的なナビゲーションテスト

### Phase 3: イベント機能テスト（2日）
- [ ] イベント作成フローテスト実装
- [ ] イベント一覧画面テスト実装
- [ ] イベント詳細画面テスト実装
- [ ] GraphQL API 統合テスト

### Phase 4: 高度なテスト（1日）
- [ ] レスポンシブデザインテスト
- [ ] ブラウザ互換性テスト
- [ ] パフォーマンステスト
- [ ] アクセシビリティテスト

### Phase 5: 最適化・レポート（1日）
- [ ] テストレポート設定
- [ ] カバレッジレポート統合
- [ ] CI/CD パイプライン最終調整
- [ ] ドキュメント作成

## 🎯 成果物

### 実装成果物
- 完全なPlaywright E2Eテストスイート
- テスト実行環境（Docker）
- CI/CD パイプライン統合
- テストレポート・カバレッジレポート

### ドキュメント
- テスト実行手順書
- テストケース一覧
- トラブルシューティングガイド
- 保守・拡張ガイドライン

## 📊 品質指標

### 目標カバレッジ
- **E2E テストカバレッジ**: 100%（全ユーザーフロー）
- **画面カバレッジ**: 100%（全実装画面）
- **機能カバレッジ**: 100%（全実装機能）

### パフォーマンス目標
- **テスト実行時間**: 10分以内
- **失敗時の診断時間**: 2分以内（スクリーンショット・ビデオ）
- **CI/CD統合**: 自動実行・自動レポート

## 🚀 開始条件

### 必要な前提条件
- [x] Docker Compose 環境が動作
- [x] フロントエンド・バックエンドが正常動作
- [x] GraphQL API が利用可能
- [x] 基本機能が実装済み

### 開始準備
- Playwright Docker サービスの確認
- テスト用データベース環境の準備
- 開発チームとのテスト方針共有
